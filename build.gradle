plugins {
    id 'java'
    id 'application'
    id "us.kirchmeier.capsule" version "1.0-rc1"
}

sourceCompatibility = 1.8
version = '1.0'

repositories {
    mavenCentral()
}

[compileJava, compileTestJava]*.options*.encoding = 'UTF-8'

mainClassName = 'edu.nau.elc.mailers.ForceCompleteMailer'

dependencies {
    compile(
            'ch.qos.logback:logback-classic:1.1.3',
            'org.slf4j:slf4j-api:1.7.12',
            'org.codehaus.groovy:groovy:2.3.5',
            'javax.mail:javax.mail-api:1.5.3'
    )
    testCompile group: 'junit', name: 'junit', version: '4.11'
}

task wrapper(type: Wrapper) {
    gradleVersion = '2.3'
}

task capsule(type: FatCapsule) {
    applicationClass mainClassName

    capsuleManifest {
        minJavaVersion = '1.8.0'
    }
}

def artifactName = rootProject.name + '-' + version + '-capsule.jar'
def execJarPath = libsDir.getCanonicalPath() + File.separator + artifactName

task runApp(type: Exec, dependsOn: capsule) {
    commandLine('java', '-jar', execJarPath)
}
